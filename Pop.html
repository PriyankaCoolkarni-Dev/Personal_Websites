<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Glass Form</title>

<style>
:root {
  --glass-bg: rgba(255, 255, 255, 0.08);
  --glass-border: rgba(255, 255, 255, 0.18);
  --accent: #22c55e;
  --error: #f87171;
}

body {
  background: linear-gradient(135deg, #020617, #0f172a);
  min-height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
  font-family: Inter, sans-serif;
  color: white;
}

.form-card {
  width: 420px;
  padding: 30px;
  background: var(--glass-bg);
  backdrop-filter: blur(16px);
  border-radius: 18px;
  border: 1px solid var(--glass-border);
  box-shadow: 0 20px 40px rgba(0,0,0,.5);
}

h2 {
  text-align: center;
  margin-bottom: 22px;
}

.form-group {
  margin-bottom: 16px;
}

label {
  font-size: 13px;
  margin-bottom: 6px;
  display: block;
}

input, select {
  width: 100%;
  padding: 12px;
  border-radius: 10px;
  background: rgba(0,0,0,.4);
  border: 1px solid var(--glass-border);
  color: white;
}

input::placeholder {
  color: #9ca3af;
}

.phone-row {
  display: flex;
  gap: 10px;
}

.phone-row select {
  width: 40%;
}

.phone-row input {
  width: 60%;
}

button {
  width: 100%;
  padding: 14px;
  border-radius: 12px;
  border: none;
  background: linear-gradient(135deg, #22c55e, #16a34a);
  font-weight: 600;
  cursor: pointer;
}

.error {
  font-size: 12px;
  color: var(--error);
  display: none;
  margin-top: 6px;
}
</style>
</head>

<body>

<div class="form-card">
<h2>User Registration</h2>

<form id="form">

  <div class="form-group">
    <label>Full Name</label>
    <input type="text" id="name" placeholder="Enter full name" required />
  </div>

  <div class="form-group">
    <label>Mobile Number</label>
    <div class="phone-row">
      <select id="country">
        <option value="+91|IN">ðŸ‡®ðŸ‡³ +91</option>
        <option value="+1|US">ðŸ‡ºðŸ‡¸ +1</option>
        <option value="+44|GB">ðŸ‡¬ðŸ‡§ +44</option>
        <option value="+61|AU">ðŸ‡¦ðŸ‡º +61</option>
      </select>
      <input type="tel" id="mobile" placeholder="Digits only" required />
    </div>
    <div class="error" id="phoneError">Invalid phone number</div>
  </div>

  <div class="form-group">
    <label>Date of Birth</label>
    <input type="date" id="dob" required />
    <div class="error" id="dobError">Must be 18+ years old</div>
  </div>

  <div class="form-group">
    <label>Email</label>
    <input type="email" id="email" placeholder="you@email.com" required />
  </div>

  <button type="submit">Submit</button>

</form>
</div>

<script>
const WEBHOOK_URL = "https://priyankak-workflow.ifsjaipur.cloud/app/contactform";

/* ===== Helpers ===== */
const toProperCase = str =>
  str.toLowerCase().replace(/\b\w/g, c => c.toUpperCase());

const is18Plus = dob => {
  const today = new Date();
  const birth = new Date(dob);
  let age = today.getFullYear() - birth.getFullYear();
  const m = today.getMonth() - birth.getMonth();
  if (m < 0 || (m === 0 && today.getDate() < birth.getDate())) age--;
  return age >= 18;
};

document.getElementById("form").addEventListener("submit", async e => {
  e.preventDefault();

  const name = toProperCase(document.getElementById("name").value.trim());
  const mobile = document.getElementById("mobile").value.trim();
  const email = document.getElementById("email").value.trim();
  const dob = document.getElementById("dob").value;

  const [dialCode, iso] = document.getElementById("country").value.split("|");

  const phoneError = document.getElementById("phoneError");
  const dobError = document.getElementById("dobError");

  phoneError.style.display = dobError.style.display = "none";

  if (!/^[0-9]{7,15}$/.test(mobile)) {
    phoneError.style.display = "block";
    return;
  }

  if (!is18Plus(dob)) {
    dobError.style.display = "block";
    return;
  }

  const payload = {
    name,
    phone: `${dialCode}${mobile}`,
    country_iso: iso,
    dob,
    email
  };

  try {
    await fetch(WEBHOOK_URL, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(payload)
    });

    alert("Submitted successfully!");
    e.target.reset();
  } catch {
    alert("Submission failed");
  }
});
</script>

</body>
</html>
